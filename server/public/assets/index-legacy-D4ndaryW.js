System.register(["./index-legacy-CZknlkAr.js","./index-legacy-B528eZIc.js","./index-legacy-MwARNnad.js","./index-legacy-Ba__d52L.js","./route-block-legacy-wdPIt6g0.js"],(function(e,t){"use strict";var a,n,i,l,s,r,u,o,c,d,v,f,h,m,p,y,$,g,b,_,k,w,S,M,D,O,C,V,x,N,T,Y,H,U,j,z,J;return{setters:[e=>{a=e.d,n=e.M,i=e.n,l=e.c,s=e.N,r=e.a,u=e.O,o=e.w,c=e.P,d=e.Q,v=e.r,f=e.y,h=e.K,m=e.z,p=e.A,y=e.H,$=e.D,g=e.E,b=e.J,_=e.C,k=e.F,w=e.G,S=e.R,M=e.S,D=e.L,O=e.T,C=e.U,V=e.V,x=e._},e=>{N=e.L,T=e.C,Y=e.B,H=e.F},e=>{U=e.s,j=e.C},e=>{z=e.T},e=>{J=e.b}],execute:function(){const[t,L]=l("switch"),W={size:i,loading:Boolean,disabled:Boolean,modelValue:n,activeColor:String,inactiveColor:String,activeValue:{type:n,default:!0},inactiveValue:{type:n,default:!1}};var I=a({name:t,props:W,emits:["change","update:modelValue"],setup(e,{emit:t,slots:a}){const n=()=>e.modelValue===e.activeValue,i=()=>{if(!e.disabled&&!e.loading){const a=n()?e.inactiveValue:e.activeValue;t("update:modelValue",a),t("change",a)}},l=()=>{if(e.loading){const t=n()?e.activeColor:e.inactiveColor;return r(N,{class:L("loading"),color:t},null)}if(a.node)return a.node()};return s((()=>e.modelValue)),()=>{var t;const{size:s,loading:o,disabled:c,activeColor:d,inactiveColor:v}=e,f=n(),h={fontSize:u(s),backgroundColor:f?d:v};return r("div",{role:"switch",class:L({on:f,loading:o,disabled:c}),style:h,tabindex:c?void 0:0,"aria-checked":f,onClick:i},[r("div",{class:L("node")},[l()]),null==(t=a.background)?void 0:t.call(a)])}}});const A=o(I);var F,q={exports:{}},B=(F||(F=1,function(e){e.exports=function(){var e=1e3,t=6e4,a=36e5,n="millisecond",i="second",l="minute",s="hour",r="day",u="week",o="month",c="quarter",d="year",v="date",f="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||t[0])+"]"}},y=function(e,t,a){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(a)+e},$={s:y,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),n=Math.floor(a/60),i=a%60;return(t<=0?"+":"-")+y(n,2,"0")+":"+y(i,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var n=12*(a.year()-t.year())+(a.month()-t.month()),i=t.clone().add(n,o),l=a-i<0,s=t.clone().add(n+(l?-1:1),o);return+(-(n+(a-i)/(l?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:o,y:d,w:u,d:r,D:v,h:s,m:l,s:i,ms:n,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},g="en",b={};b[g]=p;var _="$isDayjsObject",k=function(e){return e instanceof D||!(!e||!e[_])},w=function e(t,a,n){var i;if(!t)return g;if("string"==typeof t){var l=t.toLowerCase();b[l]&&(i=l),a&&(b[l]=a,i=l);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var r=t.name;b[r]=t,i=r}return!n&&i&&(g=i),i||!n&&g},S=function(e,t){if(k(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new D(a)},M=$;M.l=w,M.i=k,M.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var D=function(){function p(e){this.$L=w(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[_]=!0}var y=p.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(M.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(h);if(n){var i=n[2]-1||0,l=(n[7]||"0").substring(0,3);return a?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,l)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,l)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return M},y.isValid=function(){return!(this.$d.toString()===f)},y.isSame=function(e,t){var a=S(e);return this.startOf(t)<=a&&a<=this.endOf(t)},y.isAfter=function(e,t){return S(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<S(e)},y.$g=function(e,t,a){return M.u(e)?this[t]:this.set(a,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var a=this,n=!!M.u(t)||t,c=M.p(e),f=function(e,t){var i=M.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return n?i:i.endOf(r)},h=function(e,t){return M.w(a.toDate()[e].apply(a.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},m=this.$W,p=this.$M,y=this.$D,$="set"+(this.$u?"UTC":"");switch(c){case d:return n?f(1,0):f(31,11);case o:return n?f(1,p):f(0,p+1);case u:var g=this.$locale().weekStart||0,b=(m<g?m+7:m)-g;return f(n?y-b:y+(6-b),p);case r:case v:return h($+"Hours",0);case s:return h($+"Minutes",1);case l:return h($+"Seconds",2);case i:return h($+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var a,u=M.p(e),c="set"+(this.$u?"UTC":""),f=(a={},a[r]=c+"Date",a[v]=c+"Date",a[o]=c+"Month",a[d]=c+"FullYear",a[s]=c+"Hours",a[l]=c+"Minutes",a[i]=c+"Seconds",a[n]=c+"Milliseconds",a)[u],h=u===r?this.$D+(t-this.$W):t;if(u===o||u===d){var m=this.clone().set(v,1);m.$d[f](h),m.init(),this.$d=m.set(v,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[M.p(e)]()},y.add=function(n,c){var v,f=this;n=Number(n);var h=M.p(c),m=function(e){var t=S(f);return M.w(t.date(t.date()+Math.round(e*n)),f)};if(h===o)return this.set(o,this.$M+n);if(h===d)return this.set(d,this.$y+n);if(h===r)return m(1);if(h===u)return m(7);var p=(v={},v[l]=t,v[s]=a,v[i]=e,v)[h]||1,y=this.$d.getTime()+n*p;return M.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=M.z(this),l=this.$H,s=this.$m,r=this.$M,u=a.weekdays,o=a.months,c=a.meridiem,d=function(e,a,i,l){return e&&(e[a]||e(t,n))||i[a].slice(0,l)},v=function(e){return M.s(l%12||12,e,"0")},h=c||function(e,t,a){var n=e<12?"AM":"PM";return a?n.toLowerCase():n};return n.replace(m,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return M.s(t.$y,4,"0");case"M":return r+1;case"MM":return M.s(r+1,2,"0");case"MMM":return d(a.monthsShort,r,o,3);case"MMMM":return d(o,r);case"D":return t.$D;case"DD":return M.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(a.weekdaysMin,t.$W,u,2);case"ddd":return d(a.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(l);case"HH":return M.s(l,2,"0");case"h":return v(1);case"hh":return v(2);case"a":return h(l,s,!0);case"A":return h(l,s,!1);case"m":return String(s);case"mm":return M.s(s,2,"0");case"s":return String(t.$s);case"ss":return M.s(t.$s,2,"0");case"SSS":return M.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(n,v,f){var h,m=this,p=M.p(v),y=S(n),$=(y.utcOffset()-this.utcOffset())*t,g=this-y,b=function(){return M.m(m,y)};switch(p){case d:h=b()/12;break;case o:h=b();break;case c:h=b()/3;break;case u:h=(g-$)/6048e5;break;case r:h=(g-$)/864e5;break;case s:h=g/a;break;case l:h=g/t;break;case i:h=g/e;break;default:h=g}return f?h:M.a(h)},y.daysInMonth=function(){return this.endOf(o).$D},y.$locale=function(){return b[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),n=w(e,t,!0);return n&&(a.$L=n),a},y.clone=function(){return M.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},p}(),O=D.prototype;return S.prototype=O,[["$ms",n],["$s",i],["$m",l],["$H",s],["$W",r],["$M",o],["$y",d],["$D",v]].forEach((function(e){O[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,D,S),e.$i=!0),S},S.locale=w,S.isDayjs=k,S.unix=function(e){return S(1e3*e)},S.en=b[g],S.Ls=b,S.p={},S}()}(q)),q.exports);const Z=c(B),E={class:"control-page"},P={class:"cell-content"},Q={class:"cell-left"},G={class:"cell-title"},K={class:"cell-label"},R={class:"icon-group"},X={class:"edit-popup"},ee={class:"edit-header"},te={class:"edit-content"},ae={key:0,class:"boolean-edit"},ne={class:"edit-label"},ie={class:"edit-label"},le={class:"edit-footer"},se={class:"edit-popup"},re={class:"edit-header"},ue={class:"edit-footer"},oe={class:"edit-popup"},ce={class:"edit-header"},de={class:"edit-footer"},ve=a({__name:"index",setup(e){const t=d(),a=v(),n=v(),i=v(!1),l=v(!1),s=v(""),u=v(""),o=v({}),c=v({}),x=v(!1),J=v(""),L=v(""),W=v(!1),I=v(""),F=v("");function q(){let e=u.value;const t=o.value[s.value];if("number"==typeof t){const t=Number(e);if(Number.isNaN(t))return void U("请输入有效的数字");e=t}else if("boolean"==typeof t)e=Boolean(e);else if("object"==typeof t)try{e=JSON.parse(e)}catch{return void U("请输入有效的JSON格式")}JSON.stringify(e)===JSON.stringify(t)?delete c.value[s.value]:c.value[s.value]=e,n.value&&(n.value[s.value]=e),l.value=!1}function B(){J.value="",L.value="",x.value=!0}function ve(){J.value?J.value.startsWith("_")?U("字段名不能以下划线开头"):J.value in n.value?U("字段名已存在"):(c.value[J.value]=L.value,n.value&&(n.value[J.value]=L.value),x.value=!1):U("请输入字段名")}async function fe(){if(a.value?.imei&&0!==Object.keys(c.value).length)try{(await h.post("/executeTask",{imei:a.value.imei,task:"set_config",configs:c.value})).success?(U("保存成功"),c.value={},me()):U("保存失败")}catch(e){U("保存失败"),console.error("保存失败:",e)}}async function he(){if(a.value?.imei)if(I.value)if(F.value)try{(await h.post("/executeTask",{imei:a.value.imei,task:"send_sms",rcv_phone:I.value,content:F.value})).success?(U("发送成功"),W.value=!1,I.value="",F.value=""):U("发送失败")}catch(e){U("发送失败"),console.error("发送失败:",e)}else U("请输入短信内容");else U("请输入收件人")}async function me(){if(a.value?.imei){i.value=!0;try{const e=await h.post("/executeTask",{imei:a.value.imei,task:"get_config"});e.success?(n.value=e.result,o.value={...e.result}):U("获取配置失败")}catch(e){U("获取配置失败"),console.error("获取配置失败:",e)}finally{i.value=!1}}}return f((()=>{const e=t.query.device;e&&(a.value=JSON.parse(e),me())})),(e,t)=>{const d=T,v=z,f=j,h=N,U=D,me=Y,pe=A,ye=H,$e=V;return p(),m("div",E,[r(f,{inset:!0},{default:$((()=>{return[r(d,{title:"IMEI",value:a.value?.imei},null,8,["value"]),r(d,{title:"手机号",value:a.value?.phone||"未设置"},null,8,["value"]),r(d,{title:"在线状态"},{value:$((()=>[r(v,{type:a.value?.connected?"success":"danger",size:"medium"},{default:$((()=>[g(b(a.value?.connected?"在线":"离线"),1)])),_:1},8,["type"])])),_:1}),r(d,{title:"最后在线时间",value:a.value?.lastSeen?(e=a.value.lastSeen,Z(e).format("YYYY-MM-DD HH:mm:ss")):"-"},null,8,["value"])];var e})),_:1}),r(f,{inset:!0,title:"设备配置"},{default:$((()=>[i.value?(p(),_(d,{key:0,center:""},{title:$((()=>[r(h,{type:"spinner",size:"24px"},{default:$((()=>t[13]||(t[13]=[g(" 加载中... ")]))),_:1,__:[13]})])),_:1})):n.value?(p(!0),m(k,{key:1},w(n.value,((e,t)=>S((p(),_(d,{key:t,class:M({"changed-field":t in c.value})},{title:$((()=>[y("div",P,[y("div",Q,[y("div",G,b(t),1),y("div",K,b(null==e||""===e?"未配置":"object"==typeof e?JSON.stringify(e):String(e)),1)]),y("div",R,[r(U,{name:"edit",class:"edit-icon",onClick:O((a=>function(e,t){s.value=e,u.value="boolean"==typeof t||"number"==typeof t?t:JSON.stringify(t,null,2),l.value=!0}(t,e)),["stop"])},null,8,["onClick"]),r(U,{name:"delete",class:"delete-icon",onClick:O((e=>function(e){e in c.value?delete c.value[e]:n.value&&e in n.value&&(c.value[e]=null),n.value&&delete n.value[e]}(t)),["stop"])},null,8,["onClick"])])])])),_:2},1032,["class"])),[[C,!t.startsWith("_")]]))),128)):(p(),_(d,{key:2,title:"暂无配置信息"})),r(d,null,{title:$((()=>[r(me,{plain:"",block:"",type:"primary",onClick:B},{default:$((()=>t[14]||(t[14]=[g(" 新增字段 ")]))),_:1,__:[14]})])),_:1}),r(d,null,{title:$((()=>[r(me,{block:"",type:"primary",disabled:0===Object.keys(c.value).length,onClick:fe},{default:$((()=>t[15]||(t[15]=[g(" 保存所有配置 ")]))),_:1,__:[15]},8,["disabled"])])),_:1})])),_:1}),r($e,{show:l.value,"onUpdate:show":t[3]||(t[3]=e=>l.value=e),position:"bottom",round:""},{default:$((()=>[y("div",X,[y("div",ee,[t[16]||(t[16]=y("span",{class:"edit-title"},"编辑配置",-1)),r(U,{name:"cross",onClick:t[0]||(t[0]=e=>l.value=!1)})]),y("div",te,["boolean"==typeof u.value?(p(),m("div",ae,[y("span",ne,b(s.value),1),r(pe,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),size:"24"},null,8,["modelValue"])])):(p(),m(k,{key:1},[y("div",ie,b(s.value),1),r(ye,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e),type:"number"==typeof o.value[s.value]?"number":"textarea",rows:"4",autosize:"",maxlength:"500","show-word-limit":"",placeholder:"请输入配置值"},null,8,["modelValue","type"])],64))]),y("div",le,[r(me,{block:"",type:"primary",onClick:q},{default:$((()=>t[17]||(t[17]=[g(" 确定 ")]))),_:1,__:[17]})])])])),_:1},8,["show"]),r($e,{show:x.value,"onUpdate:show":t[7]||(t[7]=e=>x.value=e),position:"bottom",round:""},{default:$((()=>[y("div",se,[y("div",re,[t[18]||(t[18]=y("span",{class:"edit-title"},"新增字段",-1)),r(U,{name:"cross",onClick:t[4]||(t[4]=e=>x.value=!1)})]),y("div",null,[r(ye,{modelValue:J.value,"onUpdate:modelValue":t[5]||(t[5]=e=>J.value=e),label:"字段名",placeholder:"请输入字段名",rules:[{required:!0,message:"请输入字段名"}]},null,8,["modelValue"]),r(ye,{modelValue:L.value,"onUpdate:modelValue":t[6]||(t[6]=e=>L.value=e),label:"字段值",type:"textarea",rows:"4",autosize:"",placeholder:"请输入字段值"},null,8,["modelValue"])]),y("div",ue,[r(me,{block:"",type:"primary",onClick:ve},{default:$((()=>t[19]||(t[19]=[g(" 确定 ")]))),_:1,__:[19]})])])])),_:1},8,["show"]),r($e,{show:W.value,"onUpdate:show":t[11]||(t[11]=e=>W.value=e),position:"bottom",round:""},{default:$((()=>[y("div",oe,[y("div",ce,[t[20]||(t[20]=y("span",{class:"edit-title"},"发送短信",-1)),r(U,{name:"cross",onClick:t[8]||(t[8]=e=>W.value=!1)})]),y("div",null,[r(ye,{modelValue:I.value,"onUpdate:modelValue":t[9]||(t[9]=e=>I.value=e),label:"收件人",placeholder:"请输入收件人手机号，多个收件人用逗号分隔",rules:[{required:!0,message:"请输入收件人"}]},null,8,["modelValue"]),r(ye,{modelValue:F.value,"onUpdate:modelValue":t[10]||(t[10]=e=>F.value=e),label:"短信内容",type:"textarea",rows:"4",autosize:"",maxlength:"500","show-word-limit":"",placeholder:"请输入短信内容",rules:[{required:!0,message:"请输入短信内容"}]},null,8,["modelValue"])]),y("div",de,[r(me,{block:"",type:"primary",onClick:he},{default:$((()=>t[21]||(t[21]=[g(" 发送 ")]))),_:1,__:[21]})])])])),_:1},8,["show"]),y("div",{class:"sms-fab",onClick:t[12]||(t[12]=e=>W.value=!0)},[r(U,{name:"chat-o",size:"24"})])])}}});"function"==typeof J&&J(ve),e("default",x(ve,[["__scopeId","data-v-088d2eb3"]]))}}}));
